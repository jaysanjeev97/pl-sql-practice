CREATE TABLE PRODUCTS( PRODUCT_ID INT PRIMARY KEY, PRODUCTNAME VARCHAR2(40),STANDARD_PRICE INT,LAST_PRICE INT,CATEGORY_ID INT); 
DESCRIBE PRODUCTS;
ALTER TABLE PRODUCTS MODIFY CATEGORY_ID VARCHAR2(30);
ALTER TABLE   PRODUCTS RENAME  COLUMN LASTPRICE TO LISTPRICE;
ALTER TABLE   PRODUCTS RENAME  COLUMN PRODUCTNAME TO PRODUCT_ID;
ALTER TABLE   PRODUCTS RENAME  COLUMN CATEGORYID TO CATEGORY_ID;
ALTER TABLE   PRODUCTS RENAME  COLUMN PROID TO PRODUCT_ID;
DROP  TABLE PRODUCTS;


SELECT * FROM PRODUCTS;
commit;

-----EMPLOYEE-----

CREATE TABLE  EMPLOYEES(employee_id INT PRIMARY KEY,NAME VARCHAR2(30),
EMAIL VARCHAR2(80),PHONE INT,HIRE_DATE DATE,MANAGER_ID INT,JOB_TITLE VARCHAR2(40));
DESCRIBE EMPLOYEES;

-------CUSTOMERS-----
CREATE TABLE CUSTOMERS1( CUSTOMER_ID INT PRIMARY KEY ,NAME VARCHAR2(28),ADDRESS VARCHAR2(100),WEBSITE VARCHAR2(78),CREDIT_LIMIT INT);
DESCRIBE CUSTOMERS1;

-----ORDERS----
CREATE TABLE ORDERS( ORDER_ID INT PRIMARY KEY ,CUSTOMER_ID INT ,STATUS VARCHAR2(30),SALESMEN_ID INT,ORDER_DATE DATE,
FOREIGN KEY ( CUSTOMER_ID) REFERENCES CUSTOMERS1(CUSTOMER_ID),FOREIGN KEY ( SALESMEN_ID) REFERENCES EMPLOYEES(employee_id ));
DESCRIBE ORDERS;
DROP TABLE ORDERS;
------ORDERITEM-----
CREATE TABLE ORDER_ITEM( ORDER_ID INT,ITEM_ID INT PRIMARY KEY, PRODUCT_ID INT,QUANTITY INT, UNIT_PRICE INT,
FOREIGN KEY(ORDER_ID)REFERENCES ORDERS (ORDER_ID),FOREIGN KEY (PRODUCT_ID)REFERENCES PRODUCTS(PRODUCT_ID));
DESCRIBE ORDER_ITEM;

--------- PRODUCT-------
 
INSERT INTO PRODUCTS VALUES (101,'APPLE',50000,45000,'X12');
INSERT INTO PRODUCTS VALUES (103,'APPLE',50000,40000,'X12 MINI');
 
INSERT INTO PRODUCTS VALUES (102,'APPLE',65000,54500,'X12PRO');
INSERT INTO PRODUCTS VALUES (201,'APPLE',30000,22500,'X11 MINI');
INSERT INTO PRODUCTS VALUES (221,'APPLE',70000,65000,'X13 MAX PRO');
INSERT INTO PRODUCTS VALUES (220,'APPLE',55000,45000,'X13 MINI');
INSERT INTO PRODUCTS VALUES (301,'REDMI',15500,15000,'NOTE 8');
INSERT INTO PRODUCTS VALUES (302,'REDMI',20500,18000,'NOTE 8 PRO');
INSERT INTO PRODUCTS VALUES (121,'REDMI',15500,15000,'NOTE 7');
INSERT INTO PRODUCTS VALUES (122,'REDMI',17500,15500,'NOTE 7 PRO');
INSERT INTO PRODUCTS VALUES (123,'REDMI',10000,9000,'NOTE 6');
INSERT INTO PRODUCTS VALUES (501,'VIVO',25500,25000,'V20');
INSERT INTO PRODUCTS VALUES (503,'VIVO',75500,70000,'V75');
INSERT INTO PRODUCTS VALUES (555,'VIVO',55500,51000,'V21');
INSERT INTO PRODUCTS VALUES (444,'SAMSUNG',25500,20000,'S10');

SELECT * FROM  PRODUCTS;

------EMPLOYEE-----
INSERT INTO EMPLOYEES VALUES (101,'POTHI','POTHI@GMAIL.COM', 6385801020,'06-02-2021',100,'SALES');
INSERT INTO EMPLOYEES VALUES (102,'POTHIRAJ','POTHIRAJ@GMAIL.COM', 6385801021,'06-03-2021',100,'SALES');
INSERT INTO EMPLOYEES VALUES (103,'RAJPOTHI','RAJPOTHI@GMAIL.COM', 6385802020,'06-03-2021',100,'SALESRIDER');
INSERT INTO EMPLOYEES VALUES (105,'JAY','JAY@GMAIL.COM', 6385801000,'16-02-2021',100,'SALESMEN');
INSERT INTO EMPLOYEES VALUES (106,'GANESH','GANESH@GMAIL.COM', 6385701020,'06-02-2020',100,'SALE');
SELECT * FROM EMPLOYEES;

----------CUSTOMER------

INSERT INTO CUSTOMERS1 VALUES ( 001,'JAY','AYYANAMPAKKAM','AMAZON',100000);
INSERT INTO CUSTOMERS1 VALUES ( 002,'JAYA','AYYANAMPAKKAM','AMAZON',10000);
INSERT INTO CUSTOMERS1 VALUES ( 003,'GA`NESH','MEENAMPAKKAM','AMAZON',500000);
INSERT INTO CUSTOMERS1 VALUES ( 004,'JAYGANESH','AYYANAMPAKKAM','AMAZON',100000);
INSERT INTO CUSTOMERS1 VALUES ( 005,'RAJ','AYYANAMPAKKAM','AMAZON',100000);
INSERT INTO CUSTOMERS1 VALUES ( 006,'JAYRAJ','KATTUPAKKAM','AMAZON',55000);
INSERT INTO CUSTOMERS1 VALUES ( 007,'POTHI','SEPPAKKAM','AMAZON',100900);
INSERT INTO CUSTOMERS1 VALUES ( 008,'POTHIRAJ','AYYANAMPAKKAM','AMAZON',300000);
INSERT INTO CUSTOMERS1 VALUES ( 100,'POTHIRAJA','MEENAMPAKKAM','AMAZON',330000);
INSERT INTO CUSTOMERS1 VALUES ( 101,'POTHIRAJI','MENAMPAKKAM','AMAZON',400000);
INSERT INTO CUSTOMERS1 VALUES ( 102,'POTHIRAJU','AYYANAMPAKKAM','AMAZON',300000);
INSERT INTO CUSTOMERS1 VALUES ( 103,'POTHIRAJALU','SEPPPAKKAM','AMAZON',200000);
INSERT INTO CUSTOMERS1 VALUES ( 221,'VEL','AYYANAMPAKKAM','AMAZON',300000);
INSERT INTO CUSTOMERS1 VALUES ( 222,'VELU','MEENAMPAKKAM','AMAZON',30000);
INSERT INTO CUSTOMERS1 VALUES ( 220,'VELRAJ','AYYANAMPAKKAM','AMAZON',300000);
SELECT * FROM  CUSTOMERS1;

--------ORDER-------

INSERT INTO  ORDERS VALUES (1001, 001,'delivery',101,'01-12-2021');
INSERT INTO  ORDERS VALUES (1002, 001,'delivery',103,'1-12-2021');
INSERT INTO  ORDERS VALUES (1003, 221,'delivery',103,'2-12-2021');
INSERT INTO  ORDERS VALUES (1005, 221,'delivery',103,'2-11-2021');
INSERT INTO  ORDERS VALUES (1004, 103,'process',102,'12-12-2021');
INSERT INTO  ORDERS VALUES (1006, 221,'delivery',103,'2-11-2021');
INSERT INTO  ORDERS VALUES (1007, 222,'process',105,'12-12-2021');
INSERT INTO  ORDERS VALUES (1008, 220,'process',106,'12-7-2021');
INSERT INTO  ORDERS VALUES (1009, 004,'process',106,'12-9-2021');
INSERT INTO  ORDERS VALUES (1010, 005,'packing',103,'12-6-2021');
INSERT INTO  ORDERS VALUES (1011, 222,'process',105,'12-12-2021');
INSERT INTO  ORDERS VALUES (1013, 220,'process',106,'12-3-2021');
INSERT INTO  ORDERS VALUES (1012, 222,'process',101,'12-12-2021');
SELECT * FROM orders;

---------orderitem-------
INSERT INTO ORDER_ITEM VALUES (1001,10,101,1,50000);
INSERT INTO ORDER_ITEM VALUES (1003,11,103,2,100000);
INSERT INTO ORDER_ITEM VALUES (1005,13,101,3,15000);
INSERT INTO ORDER_ITEM VALUES (1007,12,301,2,41000);
INSERT INTO ORDER_ITEM VALUES (1008,16,103,1,15500);
INSERT INTO ORDER_ITEM VALUES (1008,15,444,1,15500);
INSERT INTO ORDER_ITEM VALUES (1009,17,101,1,50000);
INSERT INTO ORDER_ITEM VALUES (1009,18,555,1,75000);
INSERT INTO ORDER_ITEM VALUES (1009,20,503,1,50000);
INSERT INTO ORDER_ITEM VALUES (1009,21,301,3,150000);
INSERT INTO ORDER_ITEM VALUES (1013,22,302,1,50000);
INSERT INTO ORDER_ITEM VALUES (1011,23,302,1,75000);
INSERT INTO ORDER_ITEM VALUES (1013,25,221,1,60000);


 ------ JOINS------
SELECT * FROM  PRODUCTS;
SELECT * FROM ORDER_ITEM ;
SELECT*FROM PRODUCTS INNER JOIN ORDER_ITEM ON PRODUCTS.PRODUCT_ID= ORDER_ITEM.PRODUCT_ID; 
SELECT PRODUCTS.PRODUCT_ID,PRODUCTNAME,ORDER_ID,QUANTITY,UNIT_PRICE  FROM PRODUCTS INNER JOIN
ORDER_ITEM ON PRODUCTS.PRODUCT_ID= ORDER_ITEM.PRODUCT_ID;

 
 
 
 
 
 
 
SELECT * FROM ORDER_ITEM ;
SELECT * FROM ORDERS;
SELECT * FROM ORDERS O INNER JOIN ORDER_ITEM OT ON o.order_id=ot.order_id;
SELECT O.ORDER_ID,QUANTITY,UNIT_PRICE,o.order_date FROM ORDERS O INNER JOIN ORDER_ITEM OT ON o.order_id=ot.order_id;
----------DEMO-------
 
SELECT o.order_date ,SUM (OT.QUANTITY * OT.UNIT_PRICE),length (SUM (OT.QUANTITY * OT.UNIT_PRICE)) FROM ORDERS O INNER JOIN ORDER_ITEM OT ON o.order_id=ot.order_id 
where o.order_date between '02-03-2021'  and '02-12-2021' group by o.order_date ;
select *from orders;

SELECT o.order_date ,SUM (OT.QUANTITY * OT.UNIT_PRICE) AS TOATAL_PRICE , OT.ORDER_ID FROM ORDERS O 
INNER JOIN ORDER_ITEM OT ON o.order_id=ot.order_id 
where o.order_date ='12-12-2021' GROUP BY o.order_date,OT.ORDER_ID;

SELECT UNIT_PRICE FROM order_item GROUP BY unit_price;
SELECT MAX(UNIT_PRICE)FROM ORDER_ITEM;
SELECT MIN (UNIT_PRICE)FROM ORDER_ITEM;
SELECT O.order_date, SUM (OT.QUANTITY * OT.UNIT_PRICE) FROM ORDERS O INNER JOIN ORDER_ITEM OT ON 
o.order_id=ot.order_id WHERE  OT.ORDER_date =1-12-21 GROUP BY O.order_date; 

SELECT COUNT ( OT.ORDER_ID)FROM ORDERS O INNER JOIN ORDER_ITEM OT ON o.order_id=ot.order_id WHERE  OT.ORDER_ID =1001;




----------JOINS---------
SELECT
    *
FROM PRODUCTS P INNER JOIN ORDER_ITEM OT ON P.PRODUCT_ID= OT.PRODUCT_ID INNER JOIN ORDERS O ON  o.order_id=ot.order_id INNER JOIN employees E
ON o.salesmen_id =e.employee_id INNER JOIN customers1 C ON c.customer_id=o.customer_id;


SELECT E. NAME,c.name ,p.productname ,p.last_price,o.order_date, ot.quantity
    
FROM PRODUCTS P INNER JOIN ORDER_ITEM OT ON P.PRODUCT_ID= OT.PRODUCT_ID INNER JOIN ORDERS O ON  o.order_id=ot.order_id INNER JOIN employees E
ON o.salesmen_id =e.employee_id INNER JOIN customers1 C ON c.customer_id=o.customer_id;

SUBQOERY------------

SELECT P.PRODUCTNAME , P.LASTPRICE FROM PRODUCTS WHERE  O.ORDER_DATE IN(
SELECT O.ORDER_ID, O.ORDER_DATE FROM ORDERS O WHERE O.ORDER_DATE='02-11-21') ;

SELECT O.ORDER_ID, O.ORDER_DATE FROM ORDERS O WHERE O.ORDER_DATE='02-11-21';
SELECT O.ORDER_ID FROM ORDERS O WHERE O.ORDER_DATE='02-1-21';

------VIEW------
SELECT * FROM PRODUCTS;

CREATE VIEW PRT AS SELECT * FROM PRODUCTS;

SELECT*FROM PRT;

----JOINS-----

CREATE VIEW MAINPR AS
SELECT E. NAME,c.name AS CUSTOMER_NAME,p.productname ,p.last_price,o.order_date, ot.quantity
FROM PRODUCTS P INNER JOIN ORDER_ITEM OT ON P.PRODUCT_ID= OT.PRODUCT_ID 
INNER JOIN ORDERS O ON  o.order_id=ot.order_id 
INNER JOIN employees E ON o.salesmen_id =e.employee_id 
INNER JOIN customers1 C ON c.customer_id=o.customer_id;

SELECT *FROM MAINPR;

-------SEQUENCE-------
SELECT * FROM EMPLOYEES;
DESC EMPLOYEES;
CREATE SEQUENCE AUTO_INCREMENT
START WITH 107
INCREMENT BY 2;

INSERT INTO EMPLOYEES(employee_id ,NAME ,EMAIL,PHONE ,HIRE_DATE ,MANAGER_ID ,JOB_TITLE)
VALUES(AUTO_INCREMENT.NEXTVAL,'EEEE','EEE@GMAIL.COM',6666666666,'06-06-1996',100,'EEEEEEEE');

SELECT * FROM EMPLOYEES;

----------SYNONYM-------




CREATE SYNONYM P FOR PRODUCTS;

SELECT * FROM P;



















































 






